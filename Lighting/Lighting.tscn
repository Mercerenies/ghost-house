[gd_scene load_steps=7 format=2]

[ext_resource path="res://Lighting/Desaturate.tres" type="Material" id=1]
[ext_resource path="res://Lighting/Lighting.gd" type="Script" id=2]
[ext_resource path="res://Lighting/DarkBox.gd" type="Script" id=3]
[ext_resource path="res://Lighting/Lights.gd" type="Script" id=4]

[sub_resource type="CanvasItemMaterial" id=1]
blend_mode = 2

[sub_resource type="GDScript" id=2]
script/source = "extends Node2D

func _draw() -> void:
    # I don't understand why, but we need the viewport to be in UPDATE_ALWAYS update
    # mode or else we'll get an unpleasant single-frame lag at the start of the game
    # where all of the furniture, etc is visible.
    var vp = get_node(\"../Viewport\")
    draw_texture_rect(vp.get_texture(), Rect2(- vp.size / 2.0, Vector2(vp.size.x, - vp.size.y)), false)
"

[node name="Lighting" type="Node2D"]
material = ExtResource( 1 )
script = ExtResource( 2 )

[node name="Viewport" type="Viewport" parent="."]
size = Vector2( 1088, 664 )
transparent_bg = true
render_target_update_mode = 3

[node name="DarkBox" type="Polygon2D" parent="Viewport"]
color = Color( 0, 0, 0, 0.752941 )
polygon = PoolVector2Array( -124, 689, 1189, 717, 1118, -138, -128, -120 )
script = ExtResource( 3 )

[node name="Lights" type="Node2D" parent="Viewport/DarkBox"]
material = SubResource( 1 )
script = ExtResource( 4 )

[node name="DrawLayer" type="Node2D" parent="."]
script = SubResource( 2 )
